{
    "appid": "e6434377-a3e4-4a5f-bfef-4f37e53e0676",
    "name": "Sentinel",
    "description": "This app provides integration with Microsoft Sentinel",
    "type": "information",
    "product_vendor": "Microsoft",
    "logo": "logo_mssentinel.svg",
    "logo_dark": "logo_mssentinel_dark.svg",
    "product_name": "Sentinel",
    "python_version": "3",
    "product_version_regex": ".*",
    "publisher": "Splunk",
    "license": "Copyright (c) 2022-2025 Splunk Inc.",
    "app_version": "2.0.0",
    "utctime_updated": "2022-04-30T14:52:08.552463Z",
    "package_name": "phantom_mssentinel",
    "main_module": "mssentinel_connector.py",
    "min_phantom_version": "6.3.0",
    "app_wizard_version": "1.0.0",
    "rest_handler": "request_handler.handle_request",
    "fips_compliant": true,
    "configuration": {
        "tenant_id": {
            "description": "Tenant ID (e.g. 1e309abf-db6c-XXXX-a1d2-XXXXXXXXXXXX)",
            "data_type": "string",
            "required": true,
            "order": 0
        },
        "subscription_id": {
            "description": "The ID of the target subscription",
            "data_type": "string",
            "required": true,
            "order": 1
        },
        "resource_group_name": {
            "description": "The name of the resource group. The name is case insensitive",
            "data_type": "string",
            "required": true,
            "order": 2
        },
        "workspace_name": {
            "description": "The name of the workspace",
            "data_type": "string",
            "required": true,
            "order": 3
        },
        "workspace_id": {
            "description": "The id of the workspace",
            "data_type": "string",
            "required": true,
            "order": 4
        },
        "client_id": {
            "description": "Application (client) ID assigned to your Graph Security API app",
            "data_type": "string",
            "required": true,
            "order": 5
        },
        "client_secret": {
            "description": "Client Secret",
            "data_type": "password",
            "required": true,
            "order": 6
        },
        "first_run_max_incidents": {
            "description": "Maximum Incidents for scheduled polling first time",
            "data_type": "numeric",
            "default": 100,
            "order": 7
        },
        "start_time_scheduled_poll": {
            "description": "Start Time for Schedule/Manual POLL (Use this format: 1970-01-01T00:00:00Z)",
            "data_type": "string",
            "order": 8
        },
        "non_interactive": {
            "description": "Non-interactive",
            "data_type": "boolean",
            "order": 9
        }
    },
    "actions": [
        {
            "action": "test connectivity",
            "identifier": "test_asset_connectivity",
            "description": "Validate the asset configuration for connectivity",
            "type": "test",
            "read_only": true,
            "parameters": {},
            "output": [],
            "versions": "EQ(*)"
        },
        {
            "action": "on poll",
            "description": "Callback action for the on_poll ingest functionality",
            "type": "ingest",
            "identifier": "on_poll",
            "read_only": true,
            "parameters": {},
            "output": [],
            "versions": "EQ(*)"
        },
        {
            "action": "get incident",
            "identifier": "get_incident",
            "description": "Get information of given incident",
            "type": "investigate",
            "read_only": true,
            "parameters": {
                "incident_name": {
                    "description": "Incident Name",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "mssentinel incident name"
                    ],
                    "order": 0
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.incident_name",
                    "data_type": "string",
                    "example_values": [
                        "4c153924-1e22-4q91-98ca-130e9a05aa70"
                    ],
                    "contains": [
                        "mssentinel incident name"
                    ]
                },
                {
                    "data_path": "action_result.data.*.etag",
                    "data_type": "string",
                    "example_values": [
                        "\"4c153924-1e22-4q91-98ca-130e9a05aa70\""
                    ]
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.name",
                    "data_type": "string",
                    "contains": [
                        "mssentinel incident name"
                    ],
                    "column_name": "Incident Name",
                    "column_order": 0,
                    "example_values": [
                        "4c153924-1e22-4q91-98ca-130e9a05aa70"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.additionalData.alertsCount",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.additionalData.bookmarksCount",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.additionalData.commentsCount",
                    "data_type": "numeric",
                    "example_values": [
                        6
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.createdTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2023-05-12T10:17:19.7020255Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.incidentNumber",
                    "data_type": "numeric",
                    "example_values": [
                        28
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.incidentUrl",
                    "data_type": "string",
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.labels.*.labelName",
                    "data_type": "string",
                    "example_values": [
                        "Malicious"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.labels.*.labelType",
                    "data_type": "string",
                    "example_values": [
                        "User"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.lastModifiedTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2023-05-23T09:25:25.8130741Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.owner.assignedTo",
                    "data_type": "string",
                    "example_values": [
                        "Test user"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.owner.email",
                    "data_type": "string",
                    "example_values": [
                        "testuser@gmail.com"
                    ],
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.owner.objectId",
                    "data_type": "string",
                    "example_values": [
                        "4c153924-1e22-4q91-98ca-130e9a05aa70"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.owner.userPrincipalName",
                    "data_type": "string",
                    "column_name": "Owner UPN",
                    "column_order": 5,
                    "example_values": [
                        "testuser@gmail.com"
                    ],
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.severity",
                    "data_type": "string",
                    "column_name": "Severity",
                    "column_order": 4,
                    "example_values": [
                        "High"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.status",
                    "data_type": "string",
                    "column_name": "Status",
                    "column_order": 3,
                    "example_values": [
                        "Active"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.title",
                    "data_type": "string",
                    "column_name": "Title",
                    "column_order": 2,
                    "example_values": [
                        "Incident Rule"
                    ]
                },
                {
                    "data_path": "action_result.data.*.type",
                    "data_type": "string",
                    "column_name": "Type",
                    "column_order": 1,
                    "example_values": [
                        "org/Incidents"
                    ]
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Successfully retrieved incident details"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "get incident entities",
            "identifier": "get_incident_entities",
            "description": "Get all entities for an incident",
            "read_only": true,
            "type": "investigate",
            "parameters": {
                "incident_name": {
                    "description": "Incident Name",
                    "data_type": "string",
                    "primary": true,
                    "required": true,
                    "order": 0,
                    "contains": [
                        "mssentinel incident name"
                    ]
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.incident_name",
                    "data_type": "string",
                    "example_values": [
                        "4c153924-1e22-4q91-98ca-130e9a05aa70"
                    ],
                    "contains": [
                        "mssentinel incident name"
                    ]
                },
                {
                    "data_path": "action_result.data.*.entities.*.id",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.entities.*.kind",
                    "data_type": "string",
                    "example_values": [
                        "Url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.entities.*.name",
                    "data_type": "string",
                    "example_values": [
                        "4c153924-1e22-4q91-98ca-130e9a05aa70"
                    ]
                },
                {
                    "data_path": "action_result.data.*.entities.*.properties.accountName",
                    "data_type": "string",
                    "example_values": [
                        "soar"
                    ]
                },
                {
                    "data_path": "action_result.data.*.entities.*.properties.additionalData.AvStatus",
                    "data_type": "string",
                    "example_values": [
                        "Updated"
                    ]
                },
                {
                    "data_path": "action_result.data.*.entities.*.properties.additionalData.DetonationFinalUrl",
                    "data_type": "string",
                    "example_values": [
                        "testurl.com"
                    ]
                },
                {
                    "data_path": "action_result.data.*.entities.*.properties.additionalData.DetonationVerdict",
                    "data_type": "string",
                    "example_values": [
                        "GOOD"
                    ]
                },
                {
                    "data_path": "action_result.data.*.entities.*.properties.additionalData.FQDN",
                    "data_type": "string",
                    "example_values": [
                        "winatpc2"
                    ]
                },
                {
                    "data_path": "action_result.data.*.entities.*.properties.additionalData.HealthStatus",
                    "data_type": "string",
                    "example_values": [
                        "Active"
                    ]
                },
                {
                    "data_path": "action_result.data.*.entities.*.properties.additionalData.LastExternalIpAddress",
                    "data_type": "string",
                    "example_values": [
                        "8.8.8.8"
                    ]
                },
                {
                    "data_path": "action_result.data.*.entities.*.properties.additionalData.LastIpAddress",
                    "data_type": "string",
                    "example_values": [
                        "8.8.8.8"
                    ]
                },
                {
                    "data_path": "action_result.data.*.entities.*.properties.additionalData.LastSeen",
                    "data_type": "string",
                    "example_values": [
                        "2023-05-23T05:13:58.4852087Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.entities.*.properties.additionalData.LoggedOnUsers",
                    "data_type": "string",
                    "example_values": [
                        "[{\"AccountName\":\"soar\",\"DomainName\":\"WINATPC2\"}]"
                    ]
                },
                {
                    "data_path": "action_result.data.*.entities.*.properties.additionalData.MdatpDeviceId",
                    "data_type": "string",
                    "example_values": [
                        "73a08e353cvf0294f733b7b6e9499439e433a1caf"
                    ]
                },
                {
                    "data_path": "action_result.data.*.entities.*.properties.additionalData.OnboardingStatus",
                    "data_type": "string",
                    "example_values": [
                        "Onboarded"
                    ]
                },
                {
                    "data_path": "action_result.data.*.entities.*.properties.additionalData.RiskScore",
                    "data_type": "string",
                    "example_values": [
                        "High"
                    ]
                },
                {
                    "data_path": "action_result.data.*.entities.*.properties.address",
                    "data_type": "string",
                    "example_values": [
                        "8.8.8.8"
                    ]
                },
                {
                    "data_path": "action_result.data.*.entities.*.properties.algorithm",
                    "data_type": "string",
                    "example_values": [
                        "SHA1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.entities.*.properties.commandLine",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.entities.*.properties.creationTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2022-11-29T06:36:26.7483096Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.entities.*.properties.directory",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.entities.*.properties.elevationToken",
                    "data_type": "string",
                    "example_values": [
                        "Limited"
                    ]
                },
                {
                    "data_path": "action_result.data.*.entities.*.properties.fileName",
                    "data_type": "string",
                    "example_values": [
                        "chrome.exe"
                    ]
                },
                {
                    "data_path": "action_result.data.*.entities.*.properties.friendlyName",
                    "data_type": "string",
                    "example_values": [
                        "testurl.com"
                    ]
                },
                {
                    "data_path": "action_result.data.*.entities.*.properties.hashValue",
                    "data_type": "string",
                    "example_values": [
                        "b443xb3ds119e21dc8xxxx9bbafeb6fc522ec044a"
                    ]
                },
                {
                    "data_path": "action_result.data.*.entities.*.properties.hostName",
                    "data_type": "string",
                    "example_values": [
                        "winatpc2"
                    ]
                },
                {
                    "data_path": "action_result.data.*.entities.*.properties.isDomainJoined",
                    "data_type": "boolean",
                    "example_values": [
                        true,
                        false
                    ]
                },
                {
                    "data_path": "action_result.data.*.entities.*.properties.ntDomain",
                    "data_type": "string",
                    "example_values": [
                        "WINATPC2"
                    ]
                },
                {
                    "data_path": "action_result.data.*.entities.*.properties.osFamily",
                    "data_type": "string",
                    "example_values": [
                        "Windows"
                    ]
                },
                {
                    "data_path": "action_result.data.*.entities.*.properties.osVersion",
                    "data_type": "string",
                    "example_values": [
                        "22H2"
                    ]
                },
                {
                    "data_path": "action_result.data.*.entities.*.properties.processId",
                    "data_type": "string",
                    "example_values": [
                        "9644"
                    ]
                },
                {
                    "data_path": "action_result.data.*.entities.*.properties.sid",
                    "data_type": "string",
                    "example_values": [
                        "S-1-5-21-2166771715-3910420897-2790973560-1001"
                    ]
                },
                {
                    "data_path": "action_result.data.*.entities.*.properties.url",
                    "data_type": "string",
                    "example_values": [
                        "testsite.com"
                    ]
                },
                {
                    "data_path": "action_result.data.*.entities.*.type",
                    "data_type": "string",
                    "example_values": [
                        "org/Entities"
                    ]
                },
                {
                    "data_path": "action_result.data.*.metaData.*.count",
                    "data_type": "numeric",
                    "example_values": [
                        2
                    ]
                },
                {
                    "data_path": "action_result.data.*.metaData.*.entityKind",
                    "data_type": "string",
                    "example_values": [
                        "Url"
                    ]
                },
                {
                    "data_path": "action_result.summary.total_entities",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Total Entities: 1"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "versions": "EQ(*)",
            "render": {
                "type": "custom",
                "view": "mssentinel_view.get_incident_entities"
            }
        },
        {
            "action": "get incident alerts",
            "identifier": "get_incident_alerts",
            "description": "Get all alerts for an incident",
            "type": "investigate",
            "parameters": {
                "incident_name": {
                    "description": "Incident Name",
                    "data_type": "string",
                    "primary": true,
                    "required": true,
                    "order": 0,
                    "contains": [
                        "mssentinel incident name"
                    ]
                }
            },
            "read_only": true,
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.incident_name",
                    "data_type": "string",
                    "example_values": [
                        "4c153924-1e22-4q91-98ca-130e9a05aa70"
                    ],
                    "contains": [
                        "mssentinel incident name"
                    ]
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "contains": [
                        "mssentinel alert id"
                    ]
                },
                {
                    "data_path": "action_result.data.*.kind",
                    "data_type": "string",
                    "example_values": [
                        "SecurityAlert"
                    ]
                },
                {
                    "data_path": "action_result.data.*.name",
                    "data_type": "string",
                    "example_values": [
                        "4c153924-1e22-4q91-98ca-130e9a05aa70"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.additionalData.OriginalProductComponentName",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.properties.additionalData.OriginalProductName",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.properties.alertDisplayName",
                    "data_type": "string",
                    "example_values": [
                        "An active malware process was detected while executing"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.alertLink",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.properties.alertType",
                    "data_type": "string",
                    "example_values": [
                        "4c153924-1e22-4q91-98ca-130e9a05aa70"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.confidenceLevel",
                    "data_type": "string",
                    "example_values": [
                        "Unknown"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.description",
                    "data_type": "string",
                    "example_values": [
                        "Malware and unwanted software are undesirable applications that perform annoying, disruptive, or harmful actions on affected machines."
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.endTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2023-05-22T05:53:25.1335414Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.friendlyName",
                    "data_type": "string",
                    "example_values": [
                        "An active malware process was detected while executing"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.processingEndTime",
                    "data_type": "string",
                    "example_values": [
                        "2023-05-22T05:53:25.1335414Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.productName",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.properties.providerAlertId",
                    "data_type": "string",
                    "example_values": [
                        "4c153924-1e22-4q91-98ca-130e9a05aa70_1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.resourceIdentifiers.*.type",
                    "data_type": "string",
                    "example_values": [
                        "LogAnalytics"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.resourceIdentifiers.*.workspaceId",
                    "data_type": "string",
                    "example_values": [
                        "4c153924-1e22-4q91-98ca-130e9a05aa70"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.severity",
                    "data_type": "string",
                    "example_values": [
                        "Low"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.startTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2023-05-22T05:53:25.1335414Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.status",
                    "data_type": "string",
                    "example_values": [
                        "New"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.systemAlertId",
                    "data_type": "string",
                    "example_values": [
                        "4c153924-1e22-4q91-98ca-130e9a05aa70"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.timeGenerated",
                    "data_type": "string",
                    "example_values": [
                        "2023-05-22T05:53:25.1335414Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.vendorName",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.type",
                    "data_type": "string",
                    "example_values": [
                        "org/Entities"
                    ]
                },
                {
                    "data_path": "action_result.summary.total_alerts",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Total Alerts: 1"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "versions": "EQ(*)",
            "render": {
                "type": "custom",
                "view": "mssentinel_view.get_incident_alerts"
            }
        },
        {
            "action": "list incidents",
            "identifier": "list_incidents",
            "description": "Get all incidents",
            "type": "investigate",
            "read_only": true,
            "parameters": {
                "limit": {
                    "data_type": "numeric",
                    "description": "Maximum number of incidents to list (Default 100)",
                    "default": 100,
                    "order": 0
                },
                "filter": {
                    "data_type": "string",
                    "description": "Filters the results, based on a Boolean condition",
                    "order": 1
                }
            },
            "versions": "EQ(*)",
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.filter",
                    "data_type": "string",
                    "example_values": [
                        "(properties/lastModifiedTimeUtc ge 2023-05-22T10:09:26Z)"
                    ]
                },
                {
                    "data_path": "action_result.parameter.limit",
                    "data_type": "numeric",
                    "example_values": [
                        100
                    ]
                },
                {
                    "data_path": "action_result.data.*.etag",
                    "data_type": "string",
                    "example_values": [
                        "\"4c153924-1e22-4q91-98ca-130e9a05aa70\""
                    ]
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.name",
                    "data_type": "string",
                    "contains": [
                        "mssentinel incident id"
                    ],
                    "example_values": [
                        "4c153924-1e22-4q91-98ca-130e9a05aa70"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.additionalData.alertProductNames",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.properties.additionalData.alertsCount",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.additionalData.bookmarksCount",
                    "data_type": "numeric",
                    "example_values": [
                        3
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.additionalData.commentsCount",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.additionalData.tactics",
                    "data_type": "string",
                    "example_values": [
                        "InitialAccess"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.createdTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2023-05-23T11:50:19.7705938Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.description",
                    "data_type": "string",
                    "example_values": [
                        "Incident generated"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.firstActivityTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2023-05-22T11:45:27.946Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.incidentNumber",
                    "data_type": "numeric",
                    "example_values": [
                        54
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.incidentUrl",
                    "data_type": "string",
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.labels.*.labelName",
                    "data_type": "string",
                    "example_values": [
                        "Incident"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.labels.*.labelType",
                    "data_type": "string",
                    "example_values": [
                        "User"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.lastActivityTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2023-05-23T11:45:14.698Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.lastModifiedTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2023-05-23T12:10:26.6664241Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.owner.assignedTo",
                    "data_type": "string",
                    "example_values": [
                        "Test User"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.owner.email",
                    "data_type": "string",
                    "example_values": [
                        "testuser@gmail.com"
                    ],
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.owner.objectId",
                    "data_type": "string",
                    "example_values": [
                        "4c153924-1e22-4q91-98ca-130e9a05aa70"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.owner.userPrincipalName",
                    "data_type": "string",
                    "example_values": [
                        "testuser@gmail.com"
                    ],
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.relatedAnalyticRuleIds",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.properties.severity",
                    "data_type": "string",
                    "example_values": [
                        "Medium"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.status",
                    "data_type": "string",
                    "example_values": [
                        "New"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.title",
                    "data_type": "string",
                    "example_values": [
                        "IncidentRule2"
                    ]
                },
                {
                    "data_path": "action_result.data.*.type",
                    "data_type": "string",
                    "example_values": [
                        "org/Incidents"
                    ]
                },
                {
                    "data_path": "action_result.summary.total_incidents",
                    "data_type": "numeric",
                    "example_values": [
                        5
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Total incidents: 5"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "custom",
                "view": "mssentinel_view.list_incidents"
            }
        },
        {
            "action": "update incident",
            "identifier": "update_incident",
            "description": "Updates an existing incident",
            "type": "generic",
            "read_only": false,
            "parameters": {
                "incident_name": {
                    "description": "Incident Name",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "mssentinel incident name"
                    ],
                    "order": 0
                },
                "ph": {
                    "data_type": "ph",
                    "order": 1
                },
                "severity": {
                    "description": "Updated severity of the incident",
                    "data_type": "string",
                    "value_list": [
                        "High",
                        "Medium",
                        "Low",
                        "Informational"
                    ],
                    "order": 2
                },
                "status": {
                    "description": "Updated status of the incident",
                    "data_type": "string",
                    "value_list": [
                        "New",
                        "Active",
                        "Closed"
                    ],
                    "order": 3
                },
                "title": {
                    "description": "Updated title of the incident",
                    "data_type": "string",
                    "order": 4
                },
                "description": {
                    "description": "Updated description of the incident (Maximum 5000 Characters)",
                    "data_type": "string",
                    "order": 5
                },
                "owner_upn": {
                    "description": "Updated owner (userPrincipalName)",
                    "data_type": "string",
                    "order": 6
                },
                "labels": {
                    "description": "Labels relevant to this incident. Comma-seperated list allowed",
                    "data_type": "string",
                    "order": 7
                },
                "classification": {
                    "description": "The reason the incident was closed. Only updated when status is updated to Closed",
                    "data_type": "string",
                    "value_list": [
                        "BenignPositive",
                        "FalsePositive",
                        "TruePositive",
                        "Undetermined"
                    ],
                    "order": 8
                },
                "classification_comment": {
                    "description": "Describes the reason the incident was closed. Only updated when status is updated to Closed",
                    "data_type": "string",
                    "order": 9
                },
                "classification_reason": {
                    "description": "The classification reason the incident was closed with. Only updated when status is updated to Closed",
                    "data_type": "string",
                    "value_list": [
                        "InaccurateData",
                        "IncorrectAlertLogic",
                        "SuspiciousActivity",
                        "SuspiciousButExpected"
                    ],
                    "order": 10
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.classification",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.classification_comment",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.classification_reason",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.description",
                    "data_type": "string",
                    "example_values": [
                        "Incidents for updation"
                    ]
                },
                {
                    "data_path": "action_result.parameter.incident_name",
                    "data_type": "string",
                    "example_values": [
                        "4c153924-1e22-4q91-98ca-130e9a05aa70"
                    ],
                    "contains": [
                        "mssentinel incident name"
                    ]
                },
                {
                    "data_path": "action_result.parameter.labels",
                    "data_type": "string",
                    "example_values": [
                        "Tag1"
                    ]
                },
                {
                    "data_path": "action_result.parameter.owner_upn",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.severity",
                    "data_type": "string",
                    "example_values": [
                        "Medium"
                    ]
                },
                {
                    "data_path": "action_result.parameter.status",
                    "data_type": "string",
                    "example_values": [
                        "New"
                    ]
                },
                {
                    "data_path": "action_result.parameter.title",
                    "data_type": "string",
                    "example_values": [
                        "New Updated Incident"
                    ]
                },
                {
                    "data_path": "action_result.data.*.etag",
                    "data_type": "string",
                    "example_values": [
                        "\"4c153924-1e22-4q91-98ca-130e9a05aa70\""
                    ]
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.name",
                    "data_type": "string",
                    "column_name": "Incident Name",
                    "column_order": 0,
                    "contains": [
                        "mssentinel incident name"
                    ],
                    "example_values": [
                        "4c153924-1e22-4q91-98ca-130e9a05aa70"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.additionalData.alertsCount",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.additionalData.bookmarksCount",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.additionalData.commentsCount",
                    "data_type": "numeric",
                    "example_values": [
                        6
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.createdTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2023-05-12T10:17:19.7020255Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.description",
                    "data_type": "string",
                    "example_values": [
                        "Incident for test alerts"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.incidentNumber",
                    "data_type": "numeric",
                    "example_values": [
                        28
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.incidentUrl",
                    "data_type": "string",
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.labels.*.labelName",
                    "data_type": "string",
                    "example_values": [
                        "Malicious"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.labels.*.labelType",
                    "data_type": "string",
                    "example_values": [
                        "User"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.lastModifiedTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2023-05-23T10:11:17.8367091Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.owner.assignedTo",
                    "data_type": "string",
                    "example_values": [
                        "Test User"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.owner.email",
                    "data_type": "string",
                    "example_values": [
                        "testuser@gmail.com"
                    ],
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.owner.objectId",
                    "data_type": "string",
                    "example_values": [
                        "4c153924-1e22-4q91-98ca-130e9a05aa70"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.owner.userPrincipalName",
                    "data_type": "string",
                    "column_name": "Owner UPN",
                    "column_order": 5,
                    "example_values": [
                        "testuser@gmail.com"
                    ],
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.severity",
                    "data_type": "string",
                    "column_name": "Severity",
                    "column_order": 4,
                    "example_values": [
                        "Medium"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.status",
                    "data_type": "string",
                    "column_name": "Status",
                    "column_order": 3,
                    "example_values": [
                        "New"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.title",
                    "data_type": "string",
                    "column_name": "Title",
                    "column_order": 2,
                    "example_values": [
                        "New Updated Incident"
                    ]
                },
                {
                    "data_path": "action_result.data.*.type",
                    "data_type": "string",
                    "column_order": 1,
                    "column_name": "Type",
                    "example_values": [
                        "org/Incidents"
                    ]
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Incident Updated Successfully"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "add incident comment",
            "identifier": "add_incident_comment",
            "description": "Creates a new incident comment",
            "type": "generic",
            "read_only": false,
            "parameters": {
                "incident_name": {
                    "description": "Incident Name",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "mssentinel incident name"
                    ],
                    "order": 0
                },
                "message": {
                    "description": "The comment message (Upto 30,000 Characters)",
                    "data_type": "string",
                    "required": true,
                    "order": 1
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.incident_name",
                    "data_type": "string",
                    "column_name": "Incident Name",
                    "column_order": 0,
                    "example_values": [
                        "4c153924-1e22-4q91-98ca-130e9a05aa70"
                    ],
                    "contains": [
                        "mssentinel incident name"
                    ]
                },
                {
                    "data_path": "action_result.parameter.message",
                    "data_type": "string",
                    "example_values": [
                        "Update Owner"
                    ]
                },
                {
                    "data_path": "action_result.data.*.etag",
                    "data_type": "string",
                    "example_values": [
                        "\"4c153924-1e22-4q91-98ca-130e9a05aa70\""
                    ]
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.name",
                    "data_type": "string",
                    "example_values": [
                        "1684833925"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.author.email",
                    "data_type": "string",
                    "example_values": [
                        "testuser@gmail.com"
                    ],
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.author.name",
                    "data_type": "string",
                    "example_values": [
                        "User1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.author.objectId",
                    "data_type": "string",
                    "example_values": [
                        "4c153924-1e22-4q91-98ca-130e9a05aa70"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.author.userPrincipalName",
                    "data_type": "string",
                    "example_values": [
                        "testuser@gmail.com"
                    ],
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.createdTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2023-05-23T09:25:25.7863587Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.lastModifiedTimeUtc",
                    "data_type": "string",
                    "column_name": "Last Modified Time",
                    "column_order": 2,
                    "example_values": [
                        "2023-05-23T09:25:25.7863587Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.properties.message",
                    "data_type": "string",
                    "column_name": "Comment",
                    "column_order": 1,
                    "example_values": [
                        "Update Owner and status"
                    ]
                },
                {
                    "data_path": "action_result.data.*.type",
                    "data_type": "string",
                    "example_values": [
                        "org/Incidents/Comments"
                    ]
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Incident Updated Successfully"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "run query",
            "identifier": "run_query",
            "description": "Queries the Sentinel Log Analytics workspace for data using KQL",
            "type": "generic",
            "read_only": false,
            "parameters": {
                "query": {
                    "description": "Query in KQL (for example, \"SecurityIncident\" will retrieve the Sentinel incidents table)",
                    "data_type": "string",
                    "required": true,
                    "order": 0
                },
                "timespan": {
                    "description": "Time Interval in ISO 8601 Duration format. For example, \"P7D\" for last 7 days or an interval like \"2007-03-01T13:00:00Z/2008-05-11T15:30:00Z\"",
                    "data_type": "string",
                    "order": 1
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.query",
                    "data_type": "string",
                    "example_values": [
                        "SecurityIncident | project AdditionalData, Comments, Title | summarize count() by Title"
                    ]
                },
                {
                    "data_path": "action_result.parameter.timespan",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.SentinelTableName",
                    "data_type": "string",
                    "example_values": [
                        "PrimaryResult"
                    ]
                },
                {
                    "data_path": "action_result.data.*.TimeGenerated",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.Title",
                    "data_type": "string",
                    "example_values": [
                        "Suspicious activity found by incident on multiple endpoints"
                    ]
                },
                {
                    "data_path": "action_result.data.*.count_",
                    "data_type": "numeric",
                    "example_values": [
                        5
                    ]
                },
                {
                    "data_path": "action_result.summary.total_rows",
                    "data_type": "numeric",
                    "example_values": [
                        30
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Total rows: 30"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "versions": "EQ(*)",
            "render": {
                "type": "json"
            }
        }
    ]
}
